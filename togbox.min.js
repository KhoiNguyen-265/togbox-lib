Togbox.elements=[];function Togbox(options={}){if(!options.content&&!options.templateId){console.error("You must provide one of 'content' or 'templateId'.");return}if(options.content&&options.templateId){options.templateId=null;console.warn("Both 'content' and 'templateId' are specified. 'content' will take precedence, and 'templateId' will be ignored.")}if(options.templateId){this.template=document.querySelector(`#${options.templateId}`);if(!this.template){console.error(`#${options.templateId} does not exist!`);return}}this.opt=Object.assign({enableScrollLock:true,closeMethods:["button","overlay","escape"],footer:false,destroyOnClose:true,cssClass:[],scrollLockTarget:()=>document.body},options);this.content=this.opt.content;const{closeMethods:closeMethods}=this.opt;this._allowButtonClose=closeMethods.includes("button");this._allowBackdropClose=closeMethods.includes("overlay");this._allowEscapeClose=closeMethods.includes("escape");this._footerButtons=[];this._handleEscapeKey=this._handleEscapeKey.bind(this)}Togbox.prototype._getScrollbarWidth=function(){if(this._scrollbarWidth){return this._scrollbarWidth}const div=document.createElement("div");Object.assign(div.style,{position:"absolute",top:"-9999px",overflow:"scroll"});document.body.appendChild(div);this._scrollbarWidth=div.offsetWidth-div.clientWidth;document.body.removeChild(div);return this._scrollbarWidth};Togbox.prototype._build=function(){const contentNode=this.content?document.createElement("div"):this.template.content.cloneNode(true);if(this.content){contentNode.innerHTML=this.content}this._backdrop=document.createElement("div");this._backdrop.className="togbox";const container=document.createElement("div");container.className="togbox__container";this.opt.cssClass.forEach(className=>{if(typeof className==="string"){container.classList.add(className)}});if(this._allowButtonClose){const closeBtn=this._createButton("&times;","togbox__close",()=>this.close());container.append(closeBtn)}this._modalContent=document.createElement("div");this._modalContent.className="togbox__content";this._modalContent.append(contentNode);container.append(this._modalContent);if(this.opt.footer){this._modalFooter=document.createElement("div");this._modalFooter.className="togbox__footer";this._renderFooterContent();this._renderFooterButtons();container.appendChild(this._modalFooter)}this._backdrop.append(container);document.body.append(this._backdrop)};Togbox.prototype.setContent=function(content){this.content=content;if(this._modalContent){this._modalContent.innerHTML=this.content}};Togbox.prototype.setFooterContent=function(html){this._footerContent=html;this._renderFooterContent()};Togbox.prototype.addFooterButton=function(title,className,callback){const button=this._createButton(title,className,callback);this._footerButtons.push(button);this._renderFooterButtons()};Togbox.prototype._renderFooterContent=function(){if(this._modalFooter&&this._footerContent){this._modalFooter.innerHTML=this._footerContent}};Togbox.prototype._renderFooterButtons=function(){if(this._modalFooter){this._footerButtons.forEach(btn=>{this._modalFooter.append(btn)})}};Togbox.prototype._createButton=function(title,className,callback){const button=document.createElement("button");button.className=className;button.innerHTML=title;button.onclick=callback;return button};Togbox.prototype.open=function(){Togbox.elements.push(this);if(!this._backdrop){this._build()}setTimeout(()=>{this._backdrop.classList.add("togbox__backdrop--show")},0);if(this.opt.enableScrollLock){const target=this.opt.scrollLockTarget();if(this._hasScrollBar(target)){target.classList.add("togbox--no-scroll");const targetPadRight=parseInt(getComputedStyle(target).paddingRight);target.style.paddingRight=targetPadRight+this._getScrollbarWidth()+"px"}}if(this._allowBackdropClose){this._backdrop.onclick=e=>{if(e.target===this._backdrop){this.close()}}}if(this._allowEscapeClose){document.addEventListener("keydown",this._handleEscapeKey)}this._onTransitionEnd(this.opt.onOpen);return this._backdrop};Togbox.prototype._handleEscapeKey=function(e){const lastModal=Togbox.elements[Togbox.elements.length-1];if(e.key==="Escape"&&this===lastModal){this.close()}};Togbox.prototype._hasScrollBar=function(target){if([document.documentElement,document.body].includes(target)){return document.documentElement.scrollHeight>document.documentElement.clientHeight||document.body.scrollHeight>document.body.clientHeight}return target.scrollHeight>target.clientHeight};Togbox.prototype._onTransitionEnd=function(callback){this._backdrop.ontransitionend=e=>{if(e.propertyName!=="transform")return;if(typeof callback==="function"){callback()}}};Togbox.prototype.close=function(destroy=this.opt.destroyOnClose){Togbox.elements.pop();this._backdrop.classList.remove("togbox__backdrop--show");if(this._allowEscapeClose){document.removeEventListener("keydown",this._handleEscapeKey)}this._onTransitionEnd(()=>{if(destroy){this._backdrop.remove();this._backdrop=null;this._modalFooter=null}if(this.opt.enableScrollLock&&!Togbox.elements.length){const target=this.opt.scrollLockTarget();if(this._hasScrollBar(target)){target.classList.remove("togbox--no-scroll");target.style.paddingRight=""}}if(typeof this.opt.onClose==="function"){this.opt.onClose()}})};Togbox.prototype.destroy=function(){this.close(true)};